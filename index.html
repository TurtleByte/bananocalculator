<html lang="en">
<head>
	<title>F@H Points-to-Banano Calculator</title>
	<meta name="description" content="There is no conversion rate. There is no ratio. This is how many Banano you'll get for your points. Stop asking. This is it. Bookmark this so you'll never have to look for it again." />
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<script src="https://code.jquery.com/mobile/1.4.5/jquery.mobile-1.4.5.min.js"></script>
	<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.3/jquery.min.js"></script>
	<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/js/bootstrap.min.js"></script>
	<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/css/bootstrap.min.css"></head>
	
	<!-- Global site tag (gtag.js) - Google Analytics -->
	<script async src="https://www.googletagmanager.com/gtag/js?id=G-FSYSR80F3P"></script>
	<script>
	  window.dataLayer = window.dataLayer || [];
	  function gtag(){dataLayer.push(arguments);}
	  gtag('js', new Date());

	  gtag('config', 'G-FSYSR80F3P');
	</script>
<body onload="createTable(infoTableArray)">

<div class="container-fluid" style="width:90%;">
	<div class="row">
		<div class="col-sm-8">
			<h1>F@H Points-to-Banano Calculator<br>
				<small>There Is No Ratio</small>
			</h1>
			<div class="row">
				<div class="col-sm-3">
					<label class="col-2 col-form-label">
						<select id="pointsMode" class="form-control" oninput="updateValues()">
							<option value="ppd">Points Per Day</option>
							<option value="pp">Pending Points</option>
						</select>
					</label>
						<div class="col-2">
							<input class="form-control" type="number" min="0" step="1000" value="0" id="pendingpoints" oninput="updateValues()">
						</div>
						<div class="col-2">
							<label class="col-2 col-form-label">Hours Per Work Unit</label>
							<input class="form-control" type="number" min="0.1" step="0.1" value="0.1" id="foldduration" oninput="updateValues()">
						</div>
				</div>
				<div class="col-sm-6">
					<h2 align="center">
						<span id="output">???</span>
						<br>
						<small><b>Main Estimate Range</b><br><span id="text">Earnings per Day.</span></small>
					</h2>
					<p align="center"><b><span id='lowpointswarning' style="color:red"></span></b> This range covers roughly 74% of all payouts.</p>
				</div>
				<div class="col-sm-3">
					<h2 align="center">
						<span id="floorOutput">???</span>
						<br>
						<small><b>Floor Estimate</b></small>
					</h2>
					<p align="center">~99% of all payouts are above this estimate.</p>
				</div>
			</div>
			<div class="row">
				<h2><small>Things To Know</small></h2>
				<ul>
					<li><b>If your payouts are not accurately depicted here, you are "Penalized" or the payout equation has significantly changed. There is currently no way to reliably predict Penalized payouts but they account for a quarter of all payouts. It is unknown what causes an address to be Penalized. As such, it is also unknown how to remove this penalty.</b></li>
					<li>"Pending Points" are the points you have accumulated since the last time you were paid by BananoMiner. You can find out how many pending points you have by going to <a href="https://www.monkey2monkey.com/fh-stats/">Monkey2Monkey.com</a> or <a href="https://www.nanners.cc/">Nanners.cc</a>.</li>
					<li>"Points Per Day" calculations are done on the assumption that the points are evenly distributed among the 2, 12-hour pay periods that typically happen in one day.</li>
					<li>The table outlining the statistics of recent payouts may contain inaccuracies.</li>
					<li>The Main Estimate Range is a range that represents a 3% error of the Estimate Value or 6 BAN, whichever is less.</li>
					<li>Rewards are only loosely based on the price of BAN, the formula itself does not take the price into account. Instead, the payouts are manually adjusted by BananoMiner.com. It seems to be the case that the higher the peak price of BAN, the lower the payouts globally. There is as yet no evidence to suggest that this works in reverse.</li>
					<li><b>(*) Number in parentheses are included in the number of Folders Paid. They are Folders who were paid 0 BAN for their work. It was an error that has since been fixed.</b></li>
				</ul>	
				<p>If you'd like to donate some BAN, click <button class="btn" onclick="addressToClipboard()">here</button> to copy my BAN address to your clipboard.
			</div>
		</div>
		<div class="col-sm-4" style="height:85%; overflow-y:scroll;">
			<br>
			<table class="table table-striped">
				<thead>
				  <tr>
					<th>Payout</th>
					<th>BAN Distributed</th>
					<th>Folders Paid*</th>
				  </tr>
				</thead>
				<tbody id="infoTable">
				</tbody>
			</table>
		</div>
	</div>
</div>

<script>
let pendingPointsElement = document.getElementById("pendingpoints");
let banPriceElement = document.getElementById("banprice");
let pointsModeElement = document.getElementById("pointsMode");
let foldDurationElement = document.getElementById("foldduration");

$(document).ready(function(){
	$('[data-toggle="popover"]').popover(); 
	
	let params = new URLSearchParams(window.location.search);
	if (params.get("mode") && params.get("points")) {
		updateValuesInternal(params.get("mode"), params.get("points"));
		pointsModeElement.value = params.get("mode");
		pendingPointsElement.value = params.get("points");
	}
});

function updateValues() {
	updateValuesInternal(pointsModeElement.value, pendingPointsElement.value);	
}
	
function updateValuesInternal(pointsMode, pendingPoints) {
	if (pointsMode == "pp") {
		pendingPoints = parseFloat(pendingPoints);
	} else if (pointsMode == "ppd") {
		pendingPoints = parseFloat(pendingPoints) / 2;
	};
	
	banPrice = 0.0379;
	minimumPayout = 9.68
	
	if (pendingPoints > 42086000) {
		output = ((6.63 * Math.pow(10, -5) * pendingPoints + 130)).toFixed(2);
	} else if (pendingPoints > 8659958) { // intersection of this line and line below
		output = ((1.41 * Math.pow(10, -12) * Math.pow(pendingPoints, 2)) + (7.9561 * Math.pow(10, -6) * pendingPoints) + 88).toFixed(2);
	} else if(pendingPoints > 2754439){ // intersection of this line and line below
		output = ((1/(-0.05573 + (0.9538 * (1/Math.log(pendingPoints)))))).toFixed(2);
	} else if (pendingPoints >= 300000) {
		output = Math.exp(-5.0610 - Math.log(banPrice) + (0.4414 * Math.log(pendingPoints))).toFixed(2);
	} else if (pendingPoints >= 150000) {
		output = Math.exp(-6.0370 - Math.log(banPrice) + (0.5223 * Math.log(pendingPoints))).toFixed(2);
	} else if (pendingPoints >= 30000) {
		output = Math.exp(-7.3263 - Math.log(banPrice) + (0.6380 * Math.log(pendingPoints))).toFixed(2);
	} else {
		output = Math.exp(-9.5797 - Math.log(banPrice) + (0.8545 * Math.log(pendingPoints))).toFixed(2);
	}
	if (output < minimumPayout) {
		output = minimumPayout
	}
	
	let output2 = Math.exp(-15.8968 - Math.log(banPrice) + (17.6 * Math.log(Math.log(Math.log(pendingPoints))))).toFixed(2);
	if(output2 < minimumPayout){
		output2 = minimumPayout;
	} else if (pendingPoints >= 300000){
		output2 = 'N/A';
	}
	
	let floorOutput = Math.exp(-10.24 + Math.log(banPrice) + (17.6 * Math.log(Math.log(Math.log(pendingPoints))))).toFixed(2);
	let offset = Math.min(0.03 * output, 6);
	
	
	lowerBound = (output - offset).toFixed(2);
	upperBound = (parseFloat(output) + offset).toFixed(2);
	
	if (pointsMode == "ppd") {
		lowerBound = Math.max(lowerBound * 2, 0);
		upperBound = upperBound * 2;
		floorOutput = floorOutput * 2;
	}
	
	if (output == '???'){
		floorOutput = output
	}
	
	if(pendingPoints == 0){
		lowerBound = 0;
		upperBound = 0;
		floorOutput = 0;
	}
	
	if(foldDurationElement.value > 12 && pointsMode == "ppd"){
		document.getElementById("lowpointswarning").innerHTML = "Payouts occur every 12 hours. Completing a Work Unit less often than this means you will not be included in all payouts.";
		lowerBound = (lowerBound * (12 / foldDurationElement.value)).toFixed(2)
		upperBound = (upperBound * (12 / foldDurationElement.value)).toFixed(2)
	} else {
		document.getElementById("lowpointswarning").innerHTML = "";
	}
	
	document.getElementById("output").innerHTML = lowerBound + " - " + upperBound + " BAN";
	// document.getElementById("output2").innerHTML = output2 + " BAN";
	document.getElementById("floorOutput").innerHTML = floorOutput + " BAN";
	
	if (pointsMode == "ppd") {
		document.getElementById("text").innerHTML = "Estimates are in BAN per Day.";
	} else {
		document.getElementById("text").innerHTML = "Estimates are for next payout. Payouts occur at noon and midnight UTC.";
	}
}

let infoTableArray = [
	['Payout','BAN Distributed', 'Folders*'],
	['17-Jun-2021 AM',319235.27, 10054],
	['16-Jun-2021 PM',309220.75,  9591], 
	['16-Jun-2021 AM',312599.12,  9629], 
	['15-Jun-2021 PM',310176.61,  9284], 
	['15-Jun-2021 AM',320369.74, 10002], 
	['14-Jun-2021 PM',295250.13,  8878], 
	['14-Jun-2021 AM',313300.91,  9476], 
	['13-Jun-2021 PM',304399.60,  9280], 
	['13-Jun-2021 AM',312198.85,  9629], 
	['12-Jun-2021 PM',303998.66,  9329], 
	['12-Jun-2021 AM',315261.55,  9804], 
	['11-Jun-2021 PM',308671.38,  9775], 
	['11-Jun-2021 AM',316467.27,  9562], 
	['10-Jun-2021 PM',287135.91,  8506], 
	['10-Jun-2021 AM',318330.44,  9804], 
	['09-Jun-2021 PM',308049.40,  9446], 
	['09-Jun-2021 AM',307067.96,  9277], 
	['08-Jun-2021 PM',317728.62,  9807], 
	['08-Jun-2021 AM',312805.86,  9679],  
	['07-Jun-2021 PM',304515.83,  9446], 
	['07-Jun-2021 AM',375604.44,  9442], 
	['06-Jun-2021 PM',145642.30,  4470], 
	['06-Jun-2021 AM',385249.07,  9286], 
	['05-Jun-2021 PM',130030.74,  1986], 
	['05-Jun-2021 AM', 76511.26,  2386], 
	['04-Jun-2021 PM',302151.24,  9545], 
	['04-Jun-2021 AM',306792.66,  9725], 
	['03-Jun-2021 PM',297658.59,  9359], 
	['03-Jun-2021 AM',327659.78,  9866], 
	['02-Jun-2021 PM',322314.82,  9677], 
	['02-Jun-2021 AM',320505.76,  9399], 
	['01-Jun-2021 PM',314813.13,  9521], 
	['01-Jun-2021 AM',321557.01,  9578], 
	['31-May-2021 PM',307714.69,' 9280 (66)'], 
	['31-May-2021 AM',313994.70,' 9480 (89)'], 
	['30-May-2021 PM',304681.88,' 9112 (134)'], 
	['30-May-2021 AM',307321.99,' 9193 (122)'], 
	['29-May-2021 PM',292354.13,' 8868 (126)'],  
	['29-May-2021 AM',306713.57,' 9438 (161)'],
	['28-May-2021 PM',289602.21,' 8939 (127)'], 
	['28-May-2021 AM',301379.32,' 9434 (234)'],
	['27-May-2021 PM',263317.62,' 8023 (213)'], 
	['27-May-2021 AM',443912.67,'11712 (355)'], 
	['26-May-2021 PM',        0,     0],
	['26-May-2021 AM',315592.33,  9912],
	['25-May-2021 PM',409878.67,  9702],
	['25-May-2021 AM',        0,     0],
	['24-May-2021 PM',309875.06,  9541],
	['24-May-2021 AM',318870.22,  9512],
	['23-May-2021 PM',436799.97,  9748],
	['23-May-2021 AM',        0,     0],
	['22-May-2021 PM',311415.37,  9643],
	['22-May-2021 AM',311228.99,  9974],
	['21-May-2021 PM',322964.56, 10109],
	['21-May-2021 AM',328833.78, 10312],
	['20-May-2021 PM',315439.54,  9689],
	['20-May-2021 AM',312812.64,  9825],
	['19-May-2021 PM',295443.88,  9287],
	['19-May-2021 AM',307127.32,  9945],
	['18-May-2021 PM',299222.07,  9414],
	['18-May-2021 AM',299862.41,  9373],
	['17-May-2021 PM',273165.19,  8906],
	['17-May-2021 AM',288783.53,  9269],
	['16-May-2021 PM',258893.26,  8329],
	['16-May-2021 AM',274622.74,  8803],
	['15-May-2021 PM',258291.30,  8771],
	['15-May-2021 AM',265879.82,  8713],
	['14-May-2021 PM',209728.77,  7245],
	['14-May-2021 AM',264476.69,  8711],
	['13-May-2021 PM',243834.84,  7974],
	['13-May-2021 AM',257303.88,  8338],
	['12-May-2021 PM',237559.46,  7780],
	['12-May-2021 AM',253939.66,  8359],
	['11-May-2021 PM',238809.02,  7766],
	['11-May-2021 AM',246945.97,  7923],
	['10-May-2021 PM',242639.34,  8000],
	['10-May-2021 AM',238908.12,  7876],
	['09-May-2021 PM',322268.32,  8904]
]

//makes an HTML table from the array
	function createTable(array) {
		for(var i = 1; i < array.length ; i++){
			var row = document.createElement('tr');
			row.setAttribute("id", "myTr" + i);
			document.getElementById("infoTable").appendChild(row);
			for(var j = 0; j < array[i].length; j++){
				var cell = document.createElement('td');
				var content = document.createTextNode(array[i][j]);
				cell.appendChild(content);
				document.getElementById("myTr" + i).appendChild(cell);
			};
		};
	};
	
	function addressToClipboard(){
		var promise = navigator.clipboard.writeText('ban_3r7xbz8u5wj4wgkhmojzq6mmiq7ekawtarnfgwsneeck8ktn6zy58ax3ejkn')
	}

</script>
</body>
</html>
