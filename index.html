<html lang="en">
<head>
	<title>Banano Calculator</title>
	<meta name="description" content="This is how many Banano for your points. Stop asking. This is it. Just put in the numbers and you'll get your answer." />
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<script src="https://code.jquery.com/mobile/1.4.5/jquery.mobile-1.4.5.min.js"></script>
	<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.3/jquery.min.js"></script>
	<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/js/bootstrap.min.js"></script>
	<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/css/bootstrap.min.css"></head>
	
	<!-- Global site tag (gtag.js) - Google Analytics -->
	<script async src="https://www.googletagmanager.com/gtag/js?id=G-FSYSR80F3P"></script>
	<script>
	  window.dataLayer = window.dataLayer || [];
	  function gtag(){dataLayer.push(arguments);}
	  gtag('js', new Date());

	  gtag('config', 'G-FSYSR80F3P');
	</script>
<body onload="createTable(infoTableArray)">

<div class="container">
	<div class="row">
		<div class="col-sm-8">
			<h1>Banano Calculator<br>
				<small>Because you asked for it.</small>
			</h1>
			<div class="row">
				<div class="col-sm-4">
					<label class="col-2 col-form-label">Pending Points</label>
						<div class="col-2">
							<input class="form-control" type="number" min="0" step="1000" value="0" id="pendingpoints" oninput="updateValues()">
						</div>
					<br>
					<label class="col-2 col-form-label">Vertical Shift</label>
						<div class="col-2">
							<input class="form-control" type="number" min="0" step="0.00001" value="0.03685" id="banprice" oninput="updateValues()">
							(Defaulted to Latest Known Shift)
						</div>
				</div>
				<!--
				<div class="col-sm-3">
					<h2 align="center">
						<span id="output">???</span>
						<br>
						<small>Main Curve Estimate</small>
					</h2>
					<p align="center">Roughly ~38% of all payouts lie on this curve.</p>
				</div>
				-->
				<div class="col-sm-4">
					<h2 align="center">
						<span id="thirdEstimateOutput">???</span>
						<br>
						<small>Main Curve Estimate</small>
					</h2>
					<p align="center">~63% of all payouts lie on this curve.</p>
				</div>
				<div class="col-sm-4">
					<h2 align="center">
						<span id="floorOutput">???</span>
						<br>
						<small>Floor Curve Estimate</small>
					</h2>
					<p align="center">>99.99% of all payouts are above this curve.</p>
				</div>
			</div>
			<div class="row">
			<br>
			Estimates are calculated to hopefully be within 1 BAN in either direction. If your payouts are not accurately depicted here despite a correct price value and correct point total, you are either "Off-Curve" or the payout equation has significantly changed. There is currently no way to reliably predict Off-Curve payouts.
			</div>
		</div>
		<div class="col-sm-4">
			<br>
			<table class="table table-striped" >
				<thead>
				  <tr>
					<th>Payout</th>
					<th>Shift</th>
					<th>Success%</th>
				  </tr>
				</thead>
				<tbody id="infoTable">
				</tbody>
			</table>
		</div>
	</div>
</div>

<script>
$(document).ready(function(){
	$('[data-toggle="popover"]').popover(); 
});

let pendingPointsElement = document.getElementById("pendingpoints");
let banPriceElement = document.getElementById("banprice");

function updateValues(){
	pendingPoints = parseFloat(pendingPointsElement.value);
	banPrice = parseFloat(banPriceElement.value);
	/*
	if (pendingPoints >= 300000) {
		output = Math.exp(-5.0657 - Math.log(banPrice) + (0.4414 * Math.log(pendingPoints))).toFixed(2);
	} else if (pendingPoints >= 150000) {
		output = Math.exp(-6.0370 - Math.log(banPrice) + (0.5223 * Math.log(pendingPoints))).toFixed(2);
	} else if (pendingPoints >= 30000) {
		output = Math.exp(-7.3263 - Math.log(banPrice) + (0.6380 * Math.log(pendingPoints))).toFixed(2);
	} else {
		output = Math.exp(-9.5797 - Math.log(banPrice) + (0.8545 * Math.log(pendingPoints))).toFixed(2);
	}
	if (output < 9.85) {
		output = 9.85
	}
	
	let output2 = Math.exp(-19.045 - Math.log(banPrice) + (7.7 * Math.log(Math.log(pendingPoints)))).toFixed(2);
	if(output2 < 9.85){
		output2 = 9.85;
	} else if (output2 >= 100 || output2 > output) {
		output2 = output + "*"
	}
	*/
	
	let thirdCurveEstimate = Math.exp(-9.295 + Math.log(banPrice) + (17.6 * Math.log(Math.log(Math.log(pendingPoints))))).toFixed(2);
	if(thirdCurveEstimate < 9.85){
		thirdCurveEstimate = 9.85;
	}
	
	let floorOutput = Math.exp(-9.805 - Math.log(banPrice) + (0.75 * Math.log(pendingPoints))).toFixed(2);
	
	document.getElementById("thirdEstimateOutput").innerHTML = thirdCurveEstimate + " BAN";
	document.getElementById("floorOutput").innerHTML = floorOutput + " BAN";
}

let infoTableArray = [
	['Payout','Vertical Shift', 'Success Rate'],
	['09-May-2021 PM', 0.03685, '62.86%']
	/*
	['09-May-2021 AM', 'None/TBD'],
	['08-May-2021 AM/PM', 0.036700],
	['07-May-2021 AM/PM', 0.030337]
	*/
]

//makes an HTML table from the array
	function createTable(array) {
		for(var i = 1; i < array.length ; i++){
			var row = document.createElement('tr');
			row.setAttribute("id", "myTr" + i);
			document.getElementById("infoTable").appendChild(row);
			for(var j = 0; j < array[i].length; j++){
				var cell = document.createElement('td');
				var content = document.createTextNode(array[i][j]);
				cell.appendChild(content);
				document.getElementById("myTr" + i).appendChild(cell);
			};
		};
	};
</script>
</body>
</html>